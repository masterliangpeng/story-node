<!DOCTYPE html>
<html>
  <head>
    <title>小故事铺是一个专注于原创短篇故事的平台，涵盖睡前、恐怖、亲情、儿童等多个类型。每天更新精彩故事，陪你度过温暖或惊悚的时刻 - 小故事</title>
    <link rel="icon" type="image/png" href="/images/story.png">
    <link rel='stylesheet' href='/stylesheets/styles.css' />
    <link rel='stylesheet' href='/stylesheets/all.min.css' />
  </head>

  <body class="simple-mode">
    <!-- 侧边栏切换按钮（在收缩状态下可见） -->
    <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-chevron-right"></i>
    </div>

    <!-- 左侧侧边栏 -->
    <aside class="sidebar" id="sidebar">
        <nav>
            <div class="sidebar-inner">
                <!-- 侧边栏顶部 -->
                <div class="sidebar-header">
                    <div class="logo">
                        <img src="/images/story.png" alt="小故事铺" class="logo-img">
                        <span>小故事铺</span>
                    </div>
                    <button class="sidebar-close" id="sidebarClose">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>

                <!-- 功能按钮区 -->
                <div class="sidebar-actions">
                    <!-- 多功能按钮 -->
                    <div class="multi-function-button" id="multiFunctionButton">
                        <div class="action-button">
                            <i class="fas fa-cog"></i>
                            <span>基础功能</span>
                            <i class="fas fa-chevron-down function-dropdown-icon"></i>
                        </div>

                        <!-- 功能下拉菜单 -->
                        <div class="function-dropdown" id="functionDropdown">
                            <div class="function-item" id="viewModeToggle">
                                <i class="fas fa-list"></i>
                                <span>切换视图</span>
                            </div>
                            <div class="function-item" id="themeToggle">
                                <i class="fas fa-moon"></i>
                                <span>切换主题</span>
                            </div>
                            <div class="function-item" id="refreshButton">
                                <i class="fas fa-sync-alt"></i>
                                <span>重置刷新</span>
                            </div>
                            <div class="action-button" id="categorySettingsButton">
                                <i class="fas fa-sliders-h"></i>
                                <span>分类设置</span>
                            </div>
                            <div class="action-button" id="searchButton">
                                <i class="fas fa-search"></i>
                                <span>故事搜索</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 分类区域 -->
                <div class="sidebar-categories">
                    <ul class="sidebar-category-list" id="categoryTags">
                        <!-- 分类标签将通过API动态加载 -->
                        <% categoryList.forEach(function(category){ %>
                            <% const isActive = category.id == activeCategoryId; %>
                            <li class="filter-tag <%= isActive ? 'active' : '' %> category-link">
                                <a class="tag-text" href="/story/list/<%=category.id%>/1" data-id="<%= category.id %>"><%=category.name %></a>
                             </li>
                        <% }); %>
                    </ul>
                </div>

            </div>
        </nav>
    </aside>

    <!-- 主内容区域 -->
    <main class="main-container" id="mainContainer">
        <div class="container">
            <div class="content-grid" id="storyGrid">
                <!-- 故事卡片将通过动态加载 -->
                <% storyList.forEach(function(story){ %>
                <article class="content-card">
                     <div class="card-info">
                         <span class="card-category"><%=story.category_name %></span>
                         <h3 class="card-title"><a href='/story/<%=story.id %>' target=‘_blank’><%=story.title %></a></h3>
                         <p class="card-excerpt"><%=story.excerpt %></p>
                         <div class="card-meta">
                             <div class="account-name"><%=story.category_name %></div>
                             <div class="card-stats">
                                 <span><i class="far fa-file-alt"></i> <%=story.length %>字</span>
                             </div>
                         </div>
                     </div>
                 </article>
                 <% }); %>

                 <!-- 分页 -->
                 <noscript>
                     <% for(let i = 2; i <= totalPages; i++) { %>
                         <a href="/story/list/<%=activeCategoryId%>/<%= i %>">第 <%= i %> 页</a>
                     <% } %>
                 </noscript>
            </div>
        </div>
    </main>

    <!-- 页面遮罩 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-balls">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <script src="/javascripts/main.js"></script>
  </body>
</html>

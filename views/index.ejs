<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>小故事铺是一个专注于原创短篇故事的平台，涵盖睡前、恐怖、亲情、儿童等多个类型。每天更新精彩故事，陪你度过温暖或惊悚的时刻 - 小故事</title>
    <link rel="icon" type="image/png" href="/images/story.png">
    <link rel='stylesheet' href='/stylesheets/styles.css' />
    <link rel='stylesheet' href='/stylesheets/all.min.css' />

    <link rel="canonical" href="https://www.storynook.cn/">

    <!-- SEO优化meta标签 -->
    <meta name="description" content="小故事铺是专业的故事阅读平台，提供睡前故事、儿童故事、历史故事、恐怖故事、爱情故事、励志故事等各类精彩小故事。免费在线阅读，每日更新优质故事内容。">
    <meta name="keywords" content="故事,小故事,故事平台,睡前故事,儿童故事,历史故事,恐怖故事,爱情故事,励志故事,故事大全,在线阅读,免费故事,故事网站,短篇故事,经典故事,温馨故事,感人故事,哄女朋友睡觉的小故事">

    <script>
        // 检测移动端设备并跳转
        function detectMobileAndRedirect() {
            // 检测屏幕宽度
            const screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;

            // 检测用户代理字符串
            const userAgent = navigator.userAgent.toLowerCase();
            const isMobileDevice = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);

            // 如果屏幕宽度小于768px或检测到移动设备，则跳转到app.html
            if (screenWidth <= 768 || isMobileDevice) {
                // 避免无限重定向，检查当前页面是否已经是app.html
                if (!window.location.pathname.includes('/app')) {
                    window.location.href = '/app';
                }
            }
        }

        // 页面加载时检测
        detectMobileAndRedirect();

        // 监听窗口大小变化
        window.addEventListener('resize', detectMobileAndRedirect);
    </script>
  </head>

  <body class="simple-mode">

    <!-- 左侧侧边栏 -->
    <aside class="sidebar" id="sidebar">
        <nav>
            <div class="sidebar-inner">
                <!-- 侧边栏顶部 -->
                <div class="sidebar-header">
                    <div class="logo">
                        <img src="/images/story.png" alt="小故事铺" class="logo-img">
                        <span>小故事铺</span>
                    </div>
                    <button class="sidebar-close" id="sidebarClose">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>

                <!-- 功能按钮区 -->
                <div class="sidebar-actions">
                    <!-- 多功能按钮 -->
                    <div class="multi-function-button" id="multiFunctionButton">
                        <div class="action-button">
                            <i class="fas fa-cog"></i>
                            <span>基础功能</span>
                            <i class="fas fa-chevron-down function-dropdown-icon"></i>
                        </div>

                        <!-- 功能下拉菜单 -->
                        <div class="function-dropdown" id="functionDropdown">
                            <div class="function-item" id="viewModeToggle">
                                <i class="fas fa-list"></i>
                                <span>切换视图</span>
                            </div>
                            <div class="function-item" id="themeToggle">
                                <i class="fas fa-moon"></i>
                                <span>切换主题</span>
                            </div>
                            <div class="function-item" id="refreshButton">
                                <i class="fas fa-sync-alt"></i>
                                <span>重置刷新</span>
                            </div>
<!--                             <div class="action-button" id="categorySettingsButton"> -->
<!--                                 <i class="fas fa-sliders-h"></i> -->
<!--                                 <span>分类设置</span> -->
<!--                             </div> -->
<!--                             <div class="action-button" id="searchButton"> -->
<!--                                 <i class="fas fa-search"></i> -->
<!--                                 <span>故事搜索</span> -->
<!--                             </div> -->
                        </div>
                    </div>

                    <div class="action-button" id="categorySettingsButton">
                        <i class="fas fa-sliders-h"></i>
                        <span>分类设置</span>
                    </div>


                    <div class="action-button" id="searchButton">
                        <i class="fas fa-search"></i>
                        <span><a href='/story/search/page'>故事搜索</a></span>
                    </div>
                </div>

                <!-- 分类区域 -->
                <div class="sidebar-categories">
                    <ul class="sidebar-category-list" id="categoryTags">
                        <!-- 分类标签将通过API动态加载 -->
                        <% categoryList.forEach(function(category){ %>
                            <% const isActive = category.id == activeCategoryId; %>
                            <li class="filter-tag <%= isActive ? 'active' : '' %> category-link">
                                <a class="tag-text" href="/story/list/<%=category.id%>/1" data-id="<%= category.id %>"><%=category.name %></a>
                             </li>
                        <% }); %>
                    </ul>
                </div>

            </div>
        </nav>
    </aside>

    <!-- 主内容区域 -->
    <main class="main-container" id="mainContainer">
        <div class='container'>
            <div class="content-grid" id="storyGrid">
                <% if(storyList && storyList.length > 0) { %>
                    <!-- 故事卡片将通过动态加载 -->
                    <% storyList.forEach(function(story){ %>
                    <article class="content-card">
                         <div class="card-info">
                             <span class="card-category"><%=story.category_name %></span>
                             <h3 class="card-title"><a href='/story/<%=story.id %>' target=‘_blank’><%=story.title %></a></h3>
                             <p class="card-excerpt"><%=story.excerpt %></p>
                             <div class="card-meta">
                                 <div class="account-name"><%=story.category_name %></div>
                                 <div class="card-stats">
                                     <span><i class="far fa-file-alt"></i> <%=story.length %>字</span>
                                 </div>
                             </div>
                         </div>
                     </article>
                     <% }); %>

                     <!-- 分页 -->
                     <noscript>
                         <% for(let i = 2; i <= totalPages; i++) { %>
                             <a href="/story/list/<%=activeCategoryId%>/<%= i %>">第 <%= i %> 页</a>
                         <% } %>
                     </noscript>
                <% } else { %>
                    <div class="no-result">
                        <div class="no-result-icon">
                            <i class="fas fa-cat"></i>
                        </div>
                        <div class="no-result-animal">
                            <i class="fas fa-paw"></i>
                        </div>
                        <div class="no-result-title">抱歉，没有找到符合条件的故事</div>
                        <div class="no-result-text">
                            小猫咪很抱歉没有找到您想要的内容。请尝试使用不同的关键词或选择其他分类。
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
    </main>

    <!-- 侧边栏切换按钮（在收缩状态下可见） -->
    <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-chevron-right"></i>
    </div>

    <!-- 分类设置弹窗 -->
    <div class="category-settings-modal" id="categorySettingsModal">
        <div class="category-settings-container">
            <div class="settings-header">
                <h3>分类设置</h3>
                <button class="settings-close" id="settingsClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-description">
                选择您想在导航栏显示的分类（最多10个）
            </div>
            <div class="category-list" id="categorySettingsList">
                <!-- 分类选择项将通过JS动态加载 -->
            </div>
        </div>
    </div>


    <!-- 页面遮罩 -->
     <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="bouncing-loader">
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
     </div>

    <script src="/javascripts/main.js"></script>
  </body>
</html>

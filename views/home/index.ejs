<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小故事铺 - 搜索精彩故事，发现温暖与惊喜</title>
    <link rel="icon" type="image/png" href="/images/story.png">
    <link rel="preload" href="/stylesheets/search.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/stylesheets/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/live2d/css/live2d.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>

    <script async src="https://cloud.umami.is/script.js" data-website-id="9ff3dec1-fc8a-41cd-8de1-84e40212d86b"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "u5emiysnjq");
    </script>
    <script>
        function redirectHome(){
            const homepage = localStorage.getItem('homepage');
            if(homepage && homepage !== null && homepage.trim() !== '' && homepage === 'home2'){
                window.location.href = '/';
            }
        }
        redirectHome();
    </script>
</head>
    <body>
        <header class="home-header">
            <a href="/" class="brand">
                <img src="/images/story.png" alt="小故事铺" class="brand-logo" loading="lazy" decoding="async"/>
                <span class="brand-name">小故事铺</span>
            </a>
            <button class="home-select" id="homeSelectBtn" aria-label="选择主页">
                <i class="fas fa-home"></i>
            </button>
        </header>
        <main>
            <div class="floating-search" id="floatingSearch">

                <div class="floating-search-container">
                    <div class="hero">
                        <h1 class="hero-title">搜一则故事，遇见一份心情</h1>
                        <p class="hero-subtitle">支持搜索标题、摘要与分类，回车即刻呈现</p>
                        <div class="search-bar">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" id="searchInput" placeholder="试试：睡前、恐怖、亲情、儿童、励志…">
                        </div>
                        <div class="quick-tags" id="quickTags">
                            <button class="tag" data-tag="1">睡前</button>
                            <button class="tag" data-tag="11">恐怖</button>
                            <button class="tag" data-tag="8">经典</button>
                            <button class="tag" data-tag="2">儿童</button>
                            <button class="tag" data-tag="5">益智</button>
                            <button class="tag" data-tag="6">历史</button>
                            <button class="tag" data-tag="7">寓言</button>
                            <button class="tag" data-tag="9">成语</button>
                            <button class="tag" data-tag="3">童话</button>
                            <button class="tag" data-tag="10">作文</button>
                        </div>
                        <!-- 插画区域：展示开源免费插画（unDraw，MIT License） -->
                        <div class="search-illustrations" aria-label="主题插画">
                            <figure class="illustration-item">
                                <img src="/images/chahua3.svg" alt="阅读爱好者插画（来自 unDraw）" loading="lazy" decoding="async"/>
                            </figure>
                        </div>
                    </div>
                </div>

                <!-- 搜索结果区域：单列列表样式 + 空状态 -->
                <div class="search-results">
                    <div class="list-header">
                        <span class="list-label" id="listLabel"><i class="fas fa-star"></i> <%=title %></span>
                    </div>
                    <div class="results-list" id="resultsList">
                        <% storyList.forEach(function(story){ %>
                        <article class="list-item">
                            <h2 class="list-title">
                                <i class="fas fa-star star-icon" aria-hidden="true"></i>
                                <a href="/story/<%=story.id %>" target="_blank" rel="noopener"><%=story.title %></a>
                            </h2>
                            <div class="list-meta">分类：<%=story.category_name %></div>
                            <p class="list-excerpt"><%=story.excerpt %></p>
                        </article>
                        <% }); %>
                    </div>
                    <div class="empty-state" id="emptyState" style="display:none;">
<!--                         <i class="fas fa-search"></i> -->
                        <p>没有找到相关故事，试试其他关键词～</p>
                    </div>
                    </div>
                </div>

                <div class="home-modal" id="homeModal" aria-hidden="true">
                    <div class="home-modal-backdrop" id="homeModalBackdrop"></div>
                    <div class="home-modal-content" role="dialog" aria-modal="true" aria-labelledby="homeModalTitle">
                        <h3 id="homeModalTitle" class="home-modal-title">选择主页风格</h3>
                        <div class="home-options" id="homeOptions">
                            <div class="home-option" data-home="home1">
                                <img src="/images/home1.png" alt="主页一" loading="lazy" decoding="async" />
                                <div class="home-option-label">主页一</div>
                            </div>
                            <div class="home-option" data-home="home2">
                                <img src="/images/home2.png" alt="主页二" loading="lazy" decoding="async" />
                                <div class="home-option-label">主页二</div>
                            </div>
                        </div>
                        <div class="home-modal-actions">
                            <button class="home-confirm-btn" id="homeConfirmBtn">确认</button>
                            <button class="home-cancel-btn" id="homeCancelBtn">取消</button>
                        </div>
                    </div>
                </div>

                <div id="landlord">
                    <div class="message" style="opacity:0"></div>
                    <canvas id="live2d" width="560" height="500" class="live2d"></canvas>
                    <div class="hide-button">隐藏</div>
                </div>
            </div>
        </main>
        <!-- 列表局部遮罩：放在 main 元素外 -->
        <div class="list-overlay" id="listOverlay" aria-hidden="true">
            <div class="balls-loader" role="status" aria-label="加载中">
                <span class="ball"></span>
                <span class="ball"></span>
                <span class="ball"></span>
            </div>
        </div>
        <script type="text/javascript" src="/live2d/js/live2d.js"></script>
        <script type="text/javascript" src="/live2d/js/message.js"></script>
        <script type="text/javascript">
            loadlive2d("live2d", "/live2d/model/xiaoban/model.json");
        </script>
        <script src="/javascripts/search.js" defer></script>
    </body>
 </html>
